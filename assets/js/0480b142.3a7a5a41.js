"use strict";(self.webpackChunkflowmap_gl_docs=self.webpackChunkflowmap_gl_docs||[]).push([[836],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>g});var n=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},c=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,l=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),d=p(a),m=o,g=d["".concat(s,".").concat(m)]||d[m]||u[m]||l;return a?n.createElement(g,r(r({ref:t},c),{},{components:a})):n.createElement(g,r({ref:t},c))}));function g(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var l=a.length,r=new Array(l);r[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[d]="string"==typeof e?e:o,r[1]=i;for(var p=2;p<l;p++)r[p]=a[p];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},3584:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>d,frontMatter:()=>l,metadata:()=>i,toc:()=>p});var n=a(7462),o=(a(7294),a(3905));const l={sidebar_position:10},r="FAQ",i={unversionedId:"faq",id:"faq",title:"FAQ",description:"Common questions and troubleshooting tips for flowmap.gl.",source:"@site/docs/faq.md",sourceDirName:".",slug:"/faq",permalink:"/docs/faq",draft:!1,editUrl:"https://github.com/visgl/flowmap.gl-docs/docs/faq.md",tags:[],version:"current",sidebarPosition:10,frontMatter:{sidebar_position:10},sidebar:"docsSidebar",previous:{title:"TypeScript Types",permalink:"/docs/api/types"},next:{title:"Development",permalink:"/docs/development"}},s={},p=[{value:"General Questions",id:"general-questions",level:2},{value:"What is flowmap.gl?",id:"what-is-flowmapgl",level:3},{value:"What data formats are supported?",id:"what-data-formats-are-supported",level:3},{value:"Do I need a Mapbox token?",id:"do-i-need-a-mapbox-token",level:3},{value:"Performance",id:"performance",level:2},{value:"My map is slow with many flows",id:"my-map-is-slow-with-many-flows",level:3},{value:"How many flows can flowmap.gl handle?",id:"how-many-flows-can-flowmapgl-handle",level:3},{value:"Why does zooming feel sluggish?",id:"why-does-zooming-feel-sluggish",level:3},{value:"Visual Issues",id:"visual-issues",level:2},{value:"Flows are not visible",id:"flows-are-not-visible",level:3},{value:"Colors look wrong in dark/light mode",id:"colors-look-wrong-in-darklight-mode",level:3},{value:"Flows appear behind the map",id:"flows-appear-behind-the-map",level:3},{value:"Circles are not showing",id:"circles-are-not-showing",level:3},{value:"Events and Interaction",id:"events-and-interaction",level:2},{value:"onHover is not firing",id:"onhover-is-not-firing",level:3},{value:"How do I get location totals?",id:"how-do-i-get-location-totals",level:3},{value:"How do I filter flows by selected location?",id:"how-do-i-filter-flows-by-selected-location",level:3},{value:"Clustering",id:"clustering",level:2},{value:"How do I disable clustering?",id:"how-do-i-disable-clustering",level:3},{value:"Clusters have wrong positions",id:"clusters-have-wrong-positions",level:3},{value:"Can I customize cluster names?",id:"can-i-customize-cluster-names",level:3},{value:"TypeScript",id:"typescript",level:2},{value:"How do I type my location/flow objects?",id:"how-do-i-type-my-locationflow-objects",level:3},{value:"Type errors with picking info",id:"type-errors-with-picking-info",level:3},{value:"Debugging",id:"debugging",level:2},{value:"How do I debug data issues?",id:"how-do-i-debug-data-issues",level:3},{value:"Check accessor functions:",id:"check-accessor-functions",level:3},{value:"View layer state:",id:"view-layer-state",level:3},{value:"Migration",id:"migration",level:2},{value:"Upgrading from v7 to v8",id:"upgrading-from-v7-to-v8",level:3}],c={toc:p};function d(e){let{components:t,...a}=e;return(0,o.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"faq"},"FAQ"),(0,o.kt)("p",null,"Common questions and troubleshooting tips for flowmap.gl."),(0,o.kt)("h2",{id:"general-questions"},"General Questions"),(0,o.kt)("h3",{id:"what-is-flowmapgl"},"What is flowmap.gl?"),(0,o.kt)("p",null,"flowmap.gl is a WebGL-powered layer for ",(0,o.kt)("a",{parentName:"p",href:"https://deck.gl"},"deck.gl")," that visualizes movement between geographic locations. It renders flows as curved lines and locations as circles, with support for clustering, animation, and interactive features."),(0,o.kt)("h3",{id:"what-data-formats-are-supported"},"What data formats are supported?"),(0,o.kt)("p",null,"flowmap.gl accepts any object structure for locations and flows. You provide accessor functions to extract the required fields (id, lat, lon, origin, dest, count). See ",(0,o.kt)("a",{parentName:"p",href:"/docs/data-format"},"Data Format")," for details."),(0,o.kt)("h3",{id:"do-i-need-a-mapbox-token"},"Do I need a Mapbox token?"),(0,o.kt)("p",null,"Only if you want a background map. flowmap.gl works with deck.gl directly and can render flows without any base map:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"<DeckGL layers={[flowmapLayer]} controller={true}>\n  {/* No map component needed */}\n</DeckGL>\n")),(0,o.kt)("p",null,"To add a map, you'll need a token from ",(0,o.kt)("a",{parentName:"p",href:"https://www.mapbox.com/"},"Mapbox")," or use ",(0,o.kt)("a",{parentName:"p",href:"https://maplibre.org/"},"MapLibre")," with free tiles."),(0,o.kt)("h2",{id:"performance"},"Performance"),(0,o.kt)("h3",{id:"my-map-is-slow-with-many-flows"},"My map is slow with many flows"),(0,o.kt)("p",null,"Try these optimizations:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Limit displayed flows")," with ",(0,o.kt)("inlineCode",{parentName:"p"},"maxTopFlowsDisplayNum"),":"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"new FlowmapLayer({\n  maxTopFlowsDisplayNum: 3000,  // Show only top 3000 flows\n});\n"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Enable clustering")," (on by default):"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"new FlowmapLayer({\n  clusteringEnabled: true,\n  clusteringAuto: true,\n});\n"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Disable animation")," if not needed:"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"new FlowmapLayer({\n  animationEnabled: false,\n});\n"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Use a Web Worker")," for large datasets (see react-worker-app example)"))),(0,o.kt)("h3",{id:"how-many-flows-can-flowmapgl-handle"},"How many flows can flowmap.gl handle?"),(0,o.kt)("p",null,"Performance depends on hardware, but typical guidelines:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Flow Count"),(0,o.kt)("th",{parentName:"tr",align:null},"Performance"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"< 5,000"),(0,o.kt)("td",{parentName:"tr",align:null},"Smooth on most devices")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"5,000 - 20,000"),(0,o.kt)("td",{parentName:"tr",align:null},"Good with clustering enabled")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"20,000 - 100,000"),(0,o.kt)("td",{parentName:"tr",align:null},"Consider Web Worker, limit displayed flows")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"> 100,000"),(0,o.kt)("td",{parentName:"tr",align:null},"Definitely use Web Worker, pre-compute clusters")))),(0,o.kt)("h3",{id:"why-does-zooming-feel-sluggish"},"Why does zooming feel sluggish?"),(0,o.kt)("p",null,"This often happens when ",(0,o.kt)("inlineCode",{parentName:"p"},"adaptiveScalesEnabled: true")," (default) recalculates scales on each zoom. For very large datasets:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"new FlowmapLayer({\n  adaptiveScalesEnabled: false,  // Use fixed scales\n});\n")),(0,o.kt)("h2",{id:"visual-issues"},"Visual Issues"),(0,o.kt)("h3",{id:"flows-are-not-visible"},"Flows are not visible"),(0,o.kt)("p",null,"Check these common issues:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Data format"),": Ensure accessor functions match your data structure:"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"// If your data uses 'source' instead of 'origin':\ngetFlowOriginId: (flow) => flow.source,  // Not flow.origin\n"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Location coordinates"),": Verify lat/lon are numbers, not strings:"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},'// Wrong - strings from CSV\n{lat: "40.7128", lon: "-74.0060"}\n\n// Correct - numbers\n{lat: 40.7128, lon: -74.0060}\n'))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Flow magnitude"),": Ensure counts are positive numbers:"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"getFlowMagnitude: (flow) => Math.abs(flow.count),\n")))),(0,o.kt)("h3",{id:"colors-look-wrong-in-darklight-mode"},"Colors look wrong in dark/light mode"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"darkMode")," prop affects color scheme direction:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"// If using a dark background map but colors seem inverted:\nnew FlowmapLayer({\n  darkMode: true,  // Make sure this matches your map style\n});\n")),(0,o.kt)("h3",{id:"flows-appear-behind-the-map"},"Flows appear behind the map"),(0,o.kt)("p",null,"Set the proper blend mode and layer order:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"<DeckGL\n  style={{mixBlendMode: darkMode ? 'screen' : 'darken'}}\n  layers={[flowmapLayer]}\n>\n  <Map style={mapStyle} />\n</DeckGL>\n")),(0,o.kt)("h3",{id:"circles-are-not-showing"},"Circles are not showing"),(0,o.kt)("p",null,"Enable location display:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"new FlowmapLayer({\n  locationsEnabled: true,        // Show location circles\n  locationTotalsEnabled: true,   // Show in/out totals as concentric circles\n});\n")),(0,o.kt)("h2",{id:"events-and-interaction"},"Events and Interaction"),(0,o.kt)("h3",{id:"onhover-is-not-firing"},"onHover is not firing"),(0,o.kt)("p",null,"Make sure ",(0,o.kt)("inlineCode",{parentName:"p"},"pickable: true")," is set:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"new FlowmapLayer({\n  pickable: true,  // Required for hover/click events\n  onHover: (info) => { ... },\n});\n")),(0,o.kt)("h3",{id:"how-do-i-get-location-totals"},"How do I get location totals?"),(0,o.kt)("p",null,"Totals are included in the picking info for locations:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"onHover: (info) => {\n  if (info?.object?.type === 'location') {\n    const {incomingCount, outgoingCount, internalCount} = info.object.totals;\n  }\n}\n")),(0,o.kt)("h3",{id:"how-do-i-filter-flows-by-selected-location"},"How do I filter flows by selected location?"),(0,o.kt)("p",null,"Use the ",(0,o.kt)("inlineCode",{parentName:"p"},"filter")," prop:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"import {LocationFilterMode} from '@flowmap.gl/data';\n\nnew FlowmapLayer({\n  filter: {\n    selectedLocations: ['NYC', 'LA'],\n    locationFilterMode: LocationFilterMode.BETWEEN,\n  },\n});\n")),(0,o.kt)("p",null,"Filter modes:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"ALL")," - Show all flows"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"INCOMING")," - Only flows to selected locations"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"OUTGOING")," - Only flows from selected locations"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"BETWEEN")," - Only flows between selected locations")),(0,o.kt)("h2",{id:"clustering"},"Clustering"),(0,o.kt)("h3",{id:"how-do-i-disable-clustering"},"How do I disable clustering?"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"new FlowmapLayer({\n  clusteringEnabled: false,\n});\n")),(0,o.kt)("h3",{id:"clusters-have-wrong-positions"},"Clusters have wrong positions"),(0,o.kt)("p",null,"If using pre-computed clusters, ensure coordinates represent the cluster center:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"{\n  id: 'cluster-1',\n  lat: 40.5,  // Should be centroid of member locations\n  lon: -73.5,\n  children: ['NYC', 'BOS', 'PHL'],\n}\n")),(0,o.kt)("h3",{id:"can-i-customize-cluster-names"},"Can I customize cluster names?"),(0,o.kt)("p",null,"When using automatic clustering, names are generated automatically. For custom names, provide pre-computed cluster levels:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"const data = {\n  locations,\n  flows,\n  clusterLevels: [{\n    zoom: 4,\n    nodes: [{\n      id: 'east-coast',\n      name: 'East Coast Region',  // Custom name\n      lat: 40.5,\n      lon: -73.5,\n      children: ['NYC', 'BOS', 'PHL'],\n    }],\n  }],\n};\n")),(0,o.kt)("h2",{id:"typescript"},"TypeScript"),(0,o.kt)("h3",{id:"how-do-i-type-my-locationflow-objects"},"How do I type my location/flow objects?"),(0,o.kt)("p",null,"Use generics with FlowmapLayer:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"interface Location {\n  id: string;\n  name: string;\n  lat: number;\n  lon: number;\n}\n\ninterface Flow {\n  origin: string;\n  dest: string;\n  count: number;\n}\n\nnew FlowmapLayer<Location, Flow>({\n  data: {locations, flows},\n  // TypeScript now enforces correct accessor types\n});\n")),(0,o.kt)("h3",{id:"type-errors-with-picking-info"},"Type errors with picking info"),(0,o.kt)("p",null,"Import and use the PickingType enum:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"import {FlowmapLayerPickingInfo, PickingType} from '@flowmap.gl/layers';\n\nonHover: (info: FlowmapLayerPickingInfo<Location, Flow> | undefined) => {\n  if (info?.object?.type === PickingType.LOCATION) {\n    // TypeScript knows info.object has location properties\n  }\n}\n")),(0,o.kt)("h2",{id:"debugging"},"Debugging"),(0,o.kt)("h3",{id:"how-do-i-debug-data-issues"},"How do I debug data issues?"),(0,o.kt)("p",null,"Log the data to verify structure:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"console.log('Locations:', data.locations);\nconsole.log('Flows:', data.flows);\nconsole.log('Sample location:', data.locations[0]);\nconsole.log('Sample flow:', data.flows[0]);\n")),(0,o.kt)("h3",{id:"check-accessor-functions"},"Check accessor functions:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"const loc = data.locations[0];\nconsole.log('Location ID:', getLocationId(loc));\nconsole.log('Location coords:', getLocationLat(loc), getLocationLon(loc));\n\nconst flow = data.flows[0];\nconsole.log('Flow:', getFlowOriginId(flow), '\u2192', getFlowDestId(flow));\nconsole.log('Magnitude:', getFlowMagnitude(flow));\n")),(0,o.kt)("h3",{id:"view-layer-state"},"View layer state:"),(0,o.kt)("p",null,"In browser dev tools, you can inspect the deck.gl layer:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"const layer = new FlowmapLayer({...});\nconsole.log('Layer props:', layer.props);\nconsole.log('Layer state:', layer.state);\n")),(0,o.kt)("h2",{id:"migration"},"Migration"),(0,o.kt)("h3",{id:"upgrading-from-v7-to-v8"},"Upgrading from v7 to v8"),(0,o.kt)("p",null,"Key changes in v8:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Updated to deck.gl 9.x"),(0,o.kt)("li",{parentName:"ul"},"Package structure changed to ",(0,o.kt)("inlineCode",{parentName:"li"},"@flowmap.gl/layers")," and ",(0,o.kt)("inlineCode",{parentName:"li"},"@flowmap.gl/data")),(0,o.kt)("li",{parentName:"ul"},"Import paths updated")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"// v7\nimport FlowmapLayer from '@flowmap.gl/core';\n\n// v8\nimport {FlowmapLayer} from '@flowmap.gl/layers';\nimport {getViewStateForLocations} from '@flowmap.gl/data';\n")))}d.isMDXComponent=!0}}]);