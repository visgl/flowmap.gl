"use strict";(self.webpackChunkflowmap_gl_docs=self.webpackChunkflowmap_gl_docs||[]).push([[475],{3905:(n,e,t)=>{t.d(e,{Zo:()=>s,kt:()=>g});var o=t(7294);function a(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function i(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,o)}return t}function l(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?i(Object(t),!0).forEach((function(e){a(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}function r(n,e){if(null==n)return{};var t,o,a=function(n,e){if(null==n)return{};var t,o,a={},i=Object.keys(n);for(o=0;o<i.length;o++)t=i[o],e.indexOf(t)>=0||(a[t]=n[t]);return a}(n,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(o=0;o<i.length;o++)t=i[o],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(a[t]=n[t])}return a}var p=o.createContext({}),c=function(n){var e=o.useContext(p),t=e;return n&&(t="function"==typeof n?n(e):l(l({},e),n)),t},s=function(n){var e=c(n.components);return o.createElement(p.Provider,{value:e},n.children)},d="mdxType",m={inlineCode:"code",wrapper:function(n){var e=n.children;return o.createElement(o.Fragment,{},e)}},u=o.forwardRef((function(n,e){var t=n.components,a=n.mdxType,i=n.originalType,p=n.parentName,s=r(n,["components","mdxType","originalType","parentName"]),d=c(t),u=a,g=d["".concat(p,".").concat(u)]||d[u]||m[u]||i;return t?o.createElement(g,l(l({ref:e},s),{},{components:t})):o.createElement(g,l({ref:e},s))}));function g(n,e){var t=arguments,a=e&&e.mdxType;if("string"==typeof n||a){var i=t.length,l=new Array(i);l[0]=u;var r={};for(var p in e)hasOwnProperty.call(e,p)&&(r[p]=e[p]);r.originalType=n,r[d]="string"==typeof n?n:a,l[1]=r;for(var c=2;c<i;c++)l[c]=t[c];return o.createElement.apply(null,l)}return o.createElement.apply(null,t)}u.displayName="MDXCreateElement"},2180:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>p,contentTitle:()=>l,default:()=>d,frontMatter:()=>i,metadata:()=>r,toc:()=>c});var o=t(7462),a=(t(7294),t(3905));const i={sidebar_position:3},l="Svelte Integration",r={unversionedId:"guides/svelte",id:"guides/svelte",title:"Svelte Integration",description:"This guide shows how to integrate flowmap.gl with Svelte applications.",source:"@site/docs/guides/svelte.md",sourceDirName:"guides",slug:"/guides/svelte",permalink:"/docs/guides/svelte",draft:!1,editUrl:"https://github.com/visgl/flowmap.gl-docs/docs/guides/svelte.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"docsSidebar",previous:{title:"Vanilla JavaScript",permalink:"/docs/guides/vanilla-js"},next:{title:"FlowmapLayer",permalink:"/docs/api/flowmap-layer"}},p={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Basic Component",id:"basic-component",level:2},{value:"Using the Component",id:"using-the-component",level:2},{value:"Adding Tooltips",id:"adding-tooltips",level:2},{value:"With Reactive Controls",id:"with-reactive-controls",level:2},{value:"Complete Example Repository",id:"complete-example-repository",level:2},{value:"SvelteKit",id:"sveltekit",level:2}],s={toc:c};function d(n){let{components:e,...t}=n;return(0,a.kt)("wrapper",(0,o.Z)({},s,t,{components:e,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"svelte-integration"},"Svelte Integration"),(0,a.kt)("p",null,"This guide shows how to integrate flowmap.gl with Svelte applications."),(0,a.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,a.kt)("p",null,"Install the required dependencies:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"npm install @flowmap.gl/layers @flowmap.gl/data @deck.gl/core mapbox-gl\n")),(0,a.kt)("h2",{id:"basic-component"},"Basic Component"),(0,a.kt)("p",null,"Create a ",(0,a.kt)("inlineCode",{parentName:"p"},"Map.svelte")," component:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-svelte"},"<script>\n  import {onDestroy, onMount} from 'svelte';\n  import mapboxgl from 'mapbox-gl';\n  import {Deck} from '@deck.gl/core';\n  import {FlowmapLayer} from '@flowmap.gl/layers';\n  import {getViewStateForLocations} from '@flowmap.gl/data';\n\n  export let data;\n  export let darkMode = true;\n  export let colorScheme = 'Teal';\n\n  let mapContainer;\n  let deckCanvas;\n  let map;\n  let deck;\n\n  const MAPBOX_TOKEN = 'your-mapbox-token';\n\n  onMount(() => {\n    if (!data) return;\n\n    // Calculate initial view state\n    const [width, height] = [window.innerWidth, window.innerHeight];\n    const initialViewState = getViewStateForLocations(\n      data.locations,\n      (loc) => [loc.lon, loc.lat],\n      [width, height],\n      {pad: 0.3}\n    );\n\n    // Initialize Mapbox\n    map = new mapboxgl.Map({\n      container: mapContainer,\n      accessToken: MAPBOX_TOKEN,\n      style: `mapbox://styles/mapbox/${darkMode ? 'dark' : 'light'}-v10`,\n      interactive: false,\n      center: [initialViewState.longitude, initialViewState.latitude],\n      zoom: initialViewState.zoom,\n    });\n\n    // Initialize deck.gl\n    deck = new Deck({\n      canvas: deckCanvas,\n      width: '100%',\n      height: '100%',\n      initialViewState,\n      controller: true,\n      onViewStateChange: ({viewState}) => {\n        map.jumpTo({\n          center: [viewState.longitude, viewState.latitude],\n          zoom: viewState.zoom,\n          bearing: viewState.bearing,\n          pitch: viewState.pitch,\n        });\n      },\n      layers: [],\n    });\n\n    updateLayers();\n  });\n\n  onDestroy(() => {\n    if (deck) deck.finalize();\n    if (map) map.remove();\n  });\n\n  function updateLayers() {\n    if (!deck || !data) return;\n\n    deck.setProps({\n      layers: [\n        new FlowmapLayer({\n          id: 'flowmap-layer',\n          data,\n          pickable: true,\n          darkMode,\n          colorScheme,\n          getLocationId: (loc) => loc.id,\n          getLocationLat: (loc) => loc.lat,\n          getLocationLon: (loc) => loc.lon,\n          getLocationName: (loc) => loc.name,\n          getFlowOriginId: (flow) => flow.origin,\n          getFlowDestId: (flow) => flow.dest,\n          getFlowMagnitude: (flow) => flow.count,\n        }),\n      ],\n    });\n  }\n\n  // Re-render when props change\n  $: if (deck && data) {\n    updateLayers();\n  }\n<\/script>\n\n<svelte:head>\n  <link\n    rel=\"stylesheet\"\n    href=\"https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css\"\n  />\n</svelte:head>\n\n<div class=\"container\">\n  <div bind:this={mapContainer} class=\"map\"></div>\n  <canvas bind:this={deckCanvas} class=\"deck\"></canvas>\n</div>\n\n<style>\n  .container {\n    position: relative;\n    width: 100%;\n    height: 100%;\n  }\n  .map, .deck {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n  }\n  .map {\n    opacity: 0.5;\n  }\n  .deck {\n    mix-blend-mode: screen;\n  }\n</style>\n")),(0,a.kt)("h2",{id:"using-the-component"},"Using the Component"),(0,a.kt)("p",null,"In your ",(0,a.kt)("inlineCode",{parentName:"p"},"App.svelte"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-svelte"},"<script>\n  import {onMount} from 'svelte';\n  import Map from './Map.svelte';\n\n  let data = null;\n\n  onMount(async () => {\n    // Load your data\n    data = await fetchData();\n  });\n\n  async function fetchData() {\n    return {\n      locations: [\n        {id: 'NYC', name: 'New York', lat: 40.7128, lon: -74.0060},\n        {id: 'LA', name: 'Los Angeles', lat: 34.0522, lon: -118.2437},\n        {id: 'CHI', name: 'Chicago', lat: 41.8781, lon: -87.6298},\n      ],\n      flows: [\n        {origin: 'NYC', dest: 'LA', count: 1200},\n        {origin: 'NYC', dest: 'CHI', count: 850},\n        {origin: 'LA', dest: 'CHI', count: 500},\n      ],\n    };\n  }\n<\/script>\n\n{#if data}\n  <Map {data} darkMode={true} colorScheme=\"Teal\" />\n{:else}\n  <p>Loading...</p>\n{/if}\n\n<style>\n  :global(body) {\n    margin: 0;\n    padding: 0;\n    width: 100vw;\n    height: 100vh;\n  }\n</style>\n")),(0,a.kt)("h2",{id:"adding-tooltips"},"Adding Tooltips"),(0,a.kt)("p",null,"Extend the component to support tooltips:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-svelte"},"<script>\n  import {onDestroy, onMount} from 'svelte';\n  import mapboxgl from 'mapbox-gl';\n  import {Deck} from '@deck.gl/core';\n  import {FlowmapLayer} from '@flowmap.gl/layers';\n  import {getViewStateForLocations} from '@flowmap.gl/data';\n\n  export let data;\n  export let darkMode = true;\n  export let colorScheme = 'Teal';\n\n  let mapContainer;\n  let deckCanvas;\n  let map;\n  let deck;\n  let tooltip = null;\n\n  const MAPBOX_TOKEN = 'your-mapbox-token';\n\n  onMount(() => {\n    if (!data) return;\n\n    const [width, height] = [window.innerWidth, window.innerHeight];\n    const initialViewState = getViewStateForLocations(\n      data.locations,\n      (loc) => [loc.lon, loc.lat],\n      [width, height],\n      {pad: 0.3}\n    );\n\n    map = new mapboxgl.Map({\n      container: mapContainer,\n      accessToken: MAPBOX_TOKEN,\n      style: `mapbox://styles/mapbox/${darkMode ? 'dark' : 'light'}-v10`,\n      interactive: false,\n      center: [initialViewState.longitude, initialViewState.latitude],\n      zoom: initialViewState.zoom,\n    });\n\n    deck = new Deck({\n      canvas: deckCanvas,\n      width: '100%',\n      height: '100%',\n      initialViewState,\n      controller: true,\n      onViewStateChange: ({viewState}) => {\n        map.jumpTo({\n          center: [viewState.longitude, viewState.latitude],\n          zoom: viewState.zoom,\n          bearing: viewState.bearing,\n          pitch: viewState.pitch,\n        });\n        tooltip = null;  // Hide tooltip on view change\n      },\n      layers: [],\n    });\n\n    updateLayers();\n  });\n\n  onDestroy(() => {\n    if (deck) deck.finalize();\n    if (map) map.remove();\n  });\n\n  function handleHover(info) {\n    if (!info?.object) {\n      tooltip = null;\n      return;\n    }\n\n    tooltip = {\n      x: info.x,\n      y: info.y,\n      object: info.object,\n    };\n  }\n\n  function updateLayers() {\n    if (!deck || !data) return;\n\n    deck.setProps({\n      layers: [\n        new FlowmapLayer({\n          id: 'flowmap-layer',\n          data,\n          pickable: true,\n          darkMode,\n          colorScheme,\n          getLocationId: (loc) => loc.id,\n          getLocationLat: (loc) => loc.lat,\n          getLocationLon: (loc) => loc.lon,\n          getLocationName: (loc) => loc.name,\n          getFlowOriginId: (flow) => flow.origin,\n          getFlowDestId: (flow) => flow.dest,\n          getFlowMagnitude: (flow) => flow.count,\n          onHover: handleHover,\n        }),\n      ],\n    });\n  }\n\n  $: if (deck && data) {\n    updateLayers();\n  }\n<\/script>\n\n<svelte:head>\n  <link\n    rel=\"stylesheet\"\n    href=\"https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css\"\n  />\n</svelte:head>\n\n<div class=\"container\">\n  <div bind:this={mapContainer} class=\"map\"></div>\n  <canvas bind:this={deckCanvas} class=\"deck\"></canvas>\n\n  {#if tooltip}\n    <div\n      class=\"tooltip\"\n      style=\"left: {tooltip.x + 10}px; top: {tooltip.y + 10}px\"\n    >\n      {#if tooltip.object.type === 'location'}\n        <strong>{tooltip.object.name}</strong>\n        <div>In: {tooltip.object.totals.incomingCount.toLocaleString()}</div>\n        <div>Out: {tooltip.object.totals.outgoingCount.toLocaleString()}</div>\n      {:else if tooltip.object.type === 'flow'}\n        <div>{tooltip.object.origin.name} \u2192 {tooltip.object.dest.name}</div>\n        <div>{tooltip.object.count.toLocaleString()}</div>\n      {/if}\n    </div>\n  {/if}\n</div>\n\n<style>\n  .container {\n    position: relative;\n    width: 100%;\n    height: 100%;\n  }\n  .map, .deck {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n  }\n  .map {\n    opacity: 0.5;\n  }\n  .deck {\n    mix-blend-mode: screen;\n  }\n  .tooltip {\n    position: absolute;\n    background: rgba(0, 0, 0, 0.8);\n    color: white;\n    padding: 8px 12px;\n    border-radius: 4px;\n    pointer-events: none;\n    font-size: 14px;\n  }\n</style>\n")),(0,a.kt)("h2",{id:"with-reactive-controls"},"With Reactive Controls"),(0,a.kt)("p",null,"Add reactive controls using Svelte's built-in reactivity:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-svelte"},'<script>\n  import Map from \'./Map.svelte\';\n  import {onMount} from \'svelte\';\n\n  let data = null;\n  let darkMode = true;\n  let colorScheme = \'Teal\';\n  let animationEnabled = false;\n  let clusteringEnabled = true;\n\n  onMount(async () => {\n    data = await fetchData();\n  });\n\n  async function fetchData() {\n    // Your data loading logic\n  }\n<\/script>\n\n<div class="app">\n  <div class="controls">\n    <label>\n      <input type="checkbox" bind:checked={darkMode} />\n      Dark Mode\n    </label>\n    <label>\n      <input type="checkbox" bind:checked={animationEnabled} />\n      Animation\n    </label>\n    <label>\n      <input type="checkbox" bind:checked={clusteringEnabled} />\n      Clustering\n    </label>\n    <label>\n      Color Scheme:\n      <select bind:value={colorScheme}>\n        <option value="Teal">Teal</option>\n        <option value="Blues">Blues</option>\n        <option value="Greens">Greens</option>\n        <option value="Oranges">Oranges</option>\n      </select>\n    </label>\n  </div>\n\n  {#if data}\n    <Map\n      {data}\n      {darkMode}\n      {colorScheme}\n      {animationEnabled}\n      {clusteringEnabled}\n    />\n  {/if}\n</div>\n\n<style>\n  .app {\n    width: 100vw;\n    height: 100vh;\n    position: relative;\n  }\n  .controls {\n    position: absolute;\n    top: 10px;\n    left: 10px;\n    z-index: 1;\n    background: rgba(0, 0, 0, 0.8);\n    padding: 10px;\n    border-radius: 4px;\n    color: white;\n  }\n  .controls label {\n    display: block;\n    margin-bottom: 8px;\n  }\n</style>\n')),(0,a.kt)("h2",{id:"complete-example-repository"},"Complete Example Repository"),(0,a.kt)("p",null,"See the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/visgl/flowmap.gl/tree/main/examples/svelte-app"},"svelte-app example")," for a complete working setup."),(0,a.kt)("h2",{id:"sveltekit"},"SvelteKit"),(0,a.kt)("p",null,"For SvelteKit applications, ensure the component only renders on the client side:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-svelte"},"<script>\n  import {browser} from '$app/environment';\n  import {onMount} from 'svelte';\n\n  let Map;\n  let data = null;\n\n  onMount(async () => {\n    // Dynamically import to avoid SSR issues\n    Map = (await import('./Map.svelte')).default;\n    data = await fetchData();\n  });\n<\/script>\n\n{#if browser && Map && data}\n  <svelte:component this={Map} {data} />\n{/if}\n")))}d.isMDXComponent=!0}}]);