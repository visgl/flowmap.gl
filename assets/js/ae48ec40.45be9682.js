"use strict";(self.webpackChunkflowmap_gl_docs=self.webpackChunkflowmap_gl_docs||[]).push([[971],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=o.createContext({}),c=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=c(e.components);return o.createElement(s.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},g=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,p=r(e,["components","mdxType","originalType","parentName"]),d=c(n),g=a,m=d["".concat(s,".").concat(g)]||d[g]||u[g]||i;return n?o.createElement(m,l(l({ref:t},p),{},{components:n})):o.createElement(m,l({ref:t},p))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,l=new Array(i);l[0]=g;var r={};for(var s in t)hasOwnProperty.call(t,s)&&(r[s]=t[s]);r.originalType=e,r[d]="string"==typeof e?e:a,l[1]=r;for(var c=2;c<i;c++)l[c]=n[c];return o.createElement.apply(null,l)}return o.createElement.apply(null,n)}g.displayName="MDXCreateElement"},4228:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>i,metadata:()=>r,toc:()=>c});var o=n(7462),a=(n(7294),n(3905));const i={sidebar_position:1},l="React Integration",r={unversionedId:"guides/react-integration",id:"guides/react-integration",title:"React Integration",description:"This guide shows how to integrate flowmap.gl with React and react-map-gl for a full-featured flow map application.",source:"@site/docs/guides/react-integration.md",sourceDirName:"guides",slug:"/guides/react-integration",permalink:"/docs/guides/react-integration",draft:!1,editUrl:"https://github.com/visgl/flowmap.gl-docs/docs/guides/react-integration.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"docsSidebar",previous:{title:"Data Format",permalink:"/docs/data-format"},next:{title:"Vanilla JavaScript",permalink:"/docs/guides/vanilla-js"}},s={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Basic Setup",id:"basic-setup",level:2},{value:"Auto-fit View to Data",id:"auto-fit-view-to-data",level:2},{value:"Adding Tooltips",id:"adding-tooltips",level:2},{value:"Complete Example with Controls",id:"complete-example-with-controls",level:2},{value:"Tips",id:"tips",level:2},{value:"Performance with Large Datasets",id:"performance-with-large-datasets",level:3},{value:"Styling for Dark/Light Mode",id:"styling-for-darklight-mode",level:3},{value:"TypeScript Types",id:"typescript-types",level:3}],p={toc:c};function d(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,o.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"react-integration"},"React Integration"),(0,a.kt)("p",null,"This guide shows how to integrate flowmap.gl with React and react-map-gl for a full-featured flow map application."),(0,a.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,a.kt)("p",null,"Install the required dependencies:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"npm install @flowmap.gl/layers @flowmap.gl/data deck.gl @deck.gl/react react-map-gl mapbox-gl\n")),(0,a.kt)("h2",{id:"basic-setup"},"Basic Setup"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx"},"import {useState, useEffect} from 'react';\nimport DeckGL from '@deck.gl/react';\nimport {Map} from 'react-map-gl';\nimport {FlowmapLayer} from '@flowmap.gl/layers';\nimport {getViewStateForLocations} from '@flowmap.gl/data';\nimport 'mapbox-gl/dist/mapbox-gl.css';\n\nconst MAPBOX_TOKEN = 'your-mapbox-token';\n\nfunction App() {\n  const [viewState, setViewState] = useState({\n    longitude: -95,\n    latitude: 39,\n    zoom: 4,\n  });\n\n  const data = {\n    locations: [\n      {id: 'NYC', name: 'New York', lat: 40.7128, lon: -74.0060},\n      {id: 'LA', name: 'Los Angeles', lat: 34.0522, lon: -118.2437},\n      {id: 'CHI', name: 'Chicago', lat: 41.8781, lon: -87.6298},\n    ],\n    flows: [\n      {origin: 'NYC', dest: 'LA', count: 1200},\n      {origin: 'NYC', dest: 'CHI', count: 850},\n      {origin: 'LA', dest: 'CHI', count: 500},\n    ],\n  };\n\n  const layers = [\n    new FlowmapLayer({\n      id: 'flowmap-layer',\n      data,\n      pickable: true,\n      getLocationId: (loc) => loc.id,\n      getLocationLat: (loc) => loc.lat,\n      getLocationLon: (loc) => loc.lon,\n      getLocationName: (loc) => loc.name,\n      getFlowOriginId: (flow) => flow.origin,\n      getFlowDestId: (flow) => flow.dest,\n      getFlowMagnitude: (flow) => flow.count,\n    }),\n  ];\n\n  return (\n    <DeckGL\n      viewState={viewState}\n      onViewStateChange={({viewState}) => setViewState(viewState)}\n      controller={true}\n      layers={layers}\n    >\n      <Map\n        mapboxAccessToken={MAPBOX_TOKEN}\n        mapStyle=\"mapbox://styles/mapbox/dark-v10\"\n      />\n    </DeckGL>\n  );\n}\n")),(0,a.kt)("h2",{id:"auto-fit-view-to-data"},"Auto-fit View to Data"),(0,a.kt)("p",null,"Use ",(0,a.kt)("inlineCode",{parentName:"p"},"getViewStateForLocations")," to automatically calculate a view that fits all locations:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx"},"import {getViewStateForLocations} from '@flowmap.gl/data';\n\nfunction App() {\n  const [viewState, setViewState] = useState(null);\n  const [data, setData] = useState(null);\n\n  useEffect(() => {\n    // Load your data\n    fetchData().then((data) => {\n      setData(data);\n\n      // Calculate view state to fit all locations\n      const [width, height] = [window.innerWidth, window.innerHeight];\n      const initialViewState = getViewStateForLocations(\n        data.locations,\n        (loc) => [loc.lon, loc.lat],\n        [width, height],\n        {pad: 0.3}  // 30% padding around the bounds\n      );\n\n      setViewState(initialViewState);\n    });\n  }, []);\n\n  if (!viewState || !data) {\n    return <div>Loading...</div>;\n  }\n\n  // ... rest of component\n}\n")),(0,a.kt)("h2",{id:"adding-tooltips"},"Adding Tooltips"),(0,a.kt)("p",null,"Implement tooltips by tracking hover state:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx"},"import {useState} from 'react';\nimport {FlowmapLayer, PickingType} from '@flowmap.gl/layers';\n\nfunction App() {\n  const [tooltip, setTooltip] = useState(null);\n\n  const layers = [\n    new FlowmapLayer({\n      id: 'flowmap-layer',\n      data,\n      pickable: true,\n      // ... accessors\n      onHover: (info) => {\n        if (!info?.object) {\n          setTooltip(null);\n          return;\n        }\n\n        const {x, y, object} = info;\n        setTooltip({x, y, object});\n      },\n    }),\n  ];\n\n  return (\n    <div style={{position: 'relative'}}>\n      <DeckGL\n        viewState={viewState}\n        onViewStateChange={({viewState}) => setViewState(viewState)}\n        controller={true}\n        layers={layers}\n      >\n        <Map\n          mapboxAccessToken={MAPBOX_TOKEN}\n          mapStyle=\"mapbox://styles/mapbox/dark-v10\"\n        />\n      </DeckGL>\n\n      {tooltip && (\n        <div\n          style={{\n            position: 'absolute',\n            left: tooltip.x + 10,\n            top: tooltip.y + 10,\n            background: 'rgba(0, 0, 0, 0.8)',\n            color: 'white',\n            padding: '8px 12px',\n            borderRadius: '4px',\n            pointerEvents: 'none',\n          }}\n        >\n          <TooltipContent object={tooltip.object} />\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction TooltipContent({object}) {\n  switch (object.type) {\n    case PickingType.LOCATION:\n      return (\n        <div>\n          <strong>{object.name}</strong>\n          <div>Incoming: {object.totals.incomingCount.toLocaleString()}</div>\n          <div>Outgoing: {object.totals.outgoingCount.toLocaleString()}</div>\n          <div>Internal: {object.totals.internalCount.toLocaleString()}</div>\n        </div>\n      );\n\n    case PickingType.FLOW:\n      return (\n        <div>\n          <div>{object.origin.name || object.origin.id} \u2192 {object.dest.name || object.dest.id}</div>\n          <div>{object.count.toLocaleString()}</div>\n        </div>\n      );\n\n    default:\n      return null;\n  }\n}\n")),(0,a.kt)("h2",{id:"complete-example-with-controls"},"Complete Example with Controls"),(0,a.kt)("p",null,"Here's a full example with UI controls for common settings:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx"},"import {useState, useEffect, useMemo} from 'react';\nimport DeckGL from '@deck.gl/react';\nimport {Map} from 'react-map-gl';\nimport {FlowmapLayer, PickingType} from '@flowmap.gl/layers';\nimport {getViewStateForLocations} from '@flowmap.gl/data';\nimport 'mapbox-gl/dist/mapbox-gl.css';\n\nconst MAPBOX_TOKEN = 'your-mapbox-token';\n\nfunction App() {\n  const [viewState, setViewState] = useState(null);\n  const [data, setData] = useState(null);\n  const [tooltip, setTooltip] = useState(null);\n\n  // Settings\n  const [darkMode, setDarkMode] = useState(true);\n  const [colorScheme, setColorScheme] = useState('Teal');\n  const [animationEnabled, setAnimationEnabled] = useState(false);\n  const [clusteringEnabled, setClusteringEnabled] = useState(true);\n\n  useEffect(() => {\n    fetchData().then((data) => {\n      setData(data);\n      const [width, height] = [window.innerWidth, window.innerHeight];\n      setViewState(\n        getViewStateForLocations(\n          data.locations,\n          (loc) => [loc.lon, loc.lat],\n          [width, height]\n        )\n      );\n    });\n  }, []);\n\n  const layers = useMemo(() => {\n    if (!data) return [];\n\n    return [\n      new FlowmapLayer({\n        id: 'flowmap-layer',\n        data,\n        pickable: true,\n\n        // Display settings\n        darkMode,\n        colorScheme,\n        animationEnabled,\n        clusteringEnabled,\n        fadeAmount: 50,\n        highlightColor: 'orange',\n\n        // Accessors\n        getLocationId: (loc) => loc.id,\n        getLocationLat: (loc) => loc.lat,\n        getLocationLon: (loc) => loc.lon,\n        getLocationName: (loc) => loc.name,\n        getFlowOriginId: (flow) => flow.origin,\n        getFlowDestId: (flow) => flow.dest,\n        getFlowMagnitude: (flow) => flow.count,\n\n        // Events\n        onHover: (info) => {\n          setTooltip(info?.object ? {x: info.x, y: info.y, object: info.object} : null);\n        },\n      }),\n    ];\n  }, [data, darkMode, colorScheme, animationEnabled, clusteringEnabled]);\n\n  if (!viewState || !data) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <div className={darkMode ? 'dark' : 'light'} style={{position: 'relative', width: '100vw', height: '100vh'}}>\n      <DeckGL\n        viewState={viewState}\n        onViewStateChange={({viewState}) => {\n          setViewState(viewState);\n          setTooltip(null);\n        }}\n        controller={true}\n        layers={layers}\n        style={{mixBlendMode: darkMode ? 'screen' : 'darken'}}\n      >\n        <Map\n          mapboxAccessToken={MAPBOX_TOKEN}\n          mapStyle={darkMode\n            ? 'mapbox://styles/mapbox/dark-v10'\n            : 'mapbox://styles/mapbox/light-v10'\n          }\n        />\n      </DeckGL>\n\n      {/* Controls */}\n      <div style={{position: 'absolute', top: 10, left: 10, background: 'rgba(0,0,0,0.8)', padding: 10, borderRadius: 4}}>\n        <label style={{display: 'block', color: 'white', marginBottom: 8}}>\n          <input\n            type=\"checkbox\"\n            checked={darkMode}\n            onChange={(e) => setDarkMode(e.target.checked)}\n          />\n          {' '}Dark Mode\n        </label>\n        <label style={{display: 'block', color: 'white', marginBottom: 8}}>\n          <input\n            type=\"checkbox\"\n            checked={animationEnabled}\n            onChange={(e) => setAnimationEnabled(e.target.checked)}\n          />\n          {' '}Animation\n        </label>\n        <label style={{display: 'block', color: 'white', marginBottom: 8}}>\n          <input\n            type=\"checkbox\"\n            checked={clusteringEnabled}\n            onChange={(e) => setClusteringEnabled(e.target.checked)}\n          />\n          {' '}Clustering\n        </label>\n        <label style={{display: 'block', color: 'white'}}>\n          Color Scheme:{' '}\n          <select\n            value={colorScheme}\n            onChange={(e) => setColorScheme(e.target.value)}\n          >\n            <option value=\"Teal\">Teal</option>\n            <option value=\"Blues\">Blues</option>\n            <option value=\"Greens\">Greens</option>\n            <option value=\"Oranges\">Oranges</option>\n            <option value=\"Reds\">Reds</option>\n            <option value=\"Purples\">Purples</option>\n          </select>\n        </label>\n      </div>\n\n      {/* Tooltip */}\n      {tooltip && (\n        <div\n          style={{\n            position: 'absolute',\n            left: tooltip.x + 10,\n            top: tooltip.y + 10,\n            background: 'rgba(0, 0, 0, 0.9)',\n            color: 'white',\n            padding: '8px 12px',\n            borderRadius: '4px',\n            pointerEvents: 'none',\n            fontSize: '14px',\n          }}\n        >\n          {tooltip.object.type === PickingType.LOCATION ? (\n            <>\n              <div style={{fontWeight: 'bold'}}>{tooltip.object.name}</div>\n              <div>In: {tooltip.object.totals.incomingCount.toLocaleString()}</div>\n              <div>Out: {tooltip.object.totals.outgoingCount.toLocaleString()}</div>\n            </>\n          ) : tooltip.object.type === PickingType.FLOW ? (\n            <>\n              <div>{tooltip.object.origin.name} \u2192 {tooltip.object.dest.name}</div>\n              <div>{tooltip.object.count.toLocaleString()}</div>\n            </>\n          ) : null}\n        </div>\n      )}\n    </div>\n  );\n}\n\nasync function fetchData() {\n  // Replace with your data loading logic\n  return {\n    locations: [\n      {id: 'NYC', name: 'New York', lat: 40.7128, lon: -74.0060},\n      {id: 'LA', name: 'Los Angeles', lat: 34.0522, lon: -118.2437},\n      {id: 'CHI', name: 'Chicago', lat: 41.8781, lon: -87.6298},\n    ],\n    flows: [\n      {origin: 'NYC', dest: 'LA', count: 1200},\n      {origin: 'NYC', dest: 'CHI', count: 850},\n      {origin: 'LA', dest: 'CHI', count: 500},\n    ],\n  };\n}\n\nexport default App;\n")),(0,a.kt)("h2",{id:"tips"},"Tips"),(0,a.kt)("h3",{id:"performance-with-large-datasets"},"Performance with Large Datasets"),(0,a.kt)("p",null,"For better performance with large datasets:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Use ",(0,a.kt)("inlineCode",{parentName:"li"},"maxTopFlowsDisplayNum")," to limit displayed flows"),(0,a.kt)("li",{parentName:"ol"},"Enable clustering with ",(0,a.kt)("inlineCode",{parentName:"li"},"clusteringEnabled: true")),(0,a.kt)("li",{parentName:"ol"},"Consider using a Web Worker (see the react-worker-app example)")),(0,a.kt)("h3",{id:"styling-for-darklight-mode"},"Styling for Dark/Light Mode"),(0,a.kt)("p",null,"Use CSS ",(0,a.kt)("inlineCode",{parentName:"p"},"mix-blend-mode")," on the DeckGL component for better visual results:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx"},"<DeckGL\n  style={{mixBlendMode: darkMode ? 'screen' : 'darken'}}\n  // ...\n>\n")),(0,a.kt)("h3",{id:"typescript-types"},"TypeScript Types"),(0,a.kt)("p",null,"Import types for better TypeScript support:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},"import {\n  FlowmapLayer,\n  FlowmapLayerPickingInfo,\n  PickingType,\n} from '@flowmap.gl/layers';\n\nimport {\n  FlowmapData,\n  ViewState,\n} from '@flowmap.gl/data';\n\n// Define your data types\ninterface Location {\n  id: string;\n  name: string;\n  lat: number;\n  lon: number;\n}\n\ninterface Flow {\n  origin: string;\n  dest: string;\n  count: number;\n}\n\n// Use with FlowmapLayer\nnew FlowmapLayer<Location, Flow>({\n  // TypeScript will now enforce correct accessor types\n});\n")))}d.isMDXComponent=!0}}]);